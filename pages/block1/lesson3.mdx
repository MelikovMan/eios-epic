# Компоненты React, Props и однонаправленный поток данных
## 1. Что такое компоненты в React?
### 1.1. Концепция компонентов
Компонент — это независимая, переиспользуемая часть пользовательского интерфейса, которая инкапсулирует:

* Внешний вид (разметка JSX)

* Логику (JavaScript код)

* Состояние (данные компонента)

* Поведение (обработчики событий)

```jsx
// Простейший компонент - функция, возвращающая JSX
function Welcome() {
  return <h1>Добро пожаловать в наше приложение!</h1>;
}

// Использование компонента
function App() {
  return (
    <div>
      <Welcome />
    </div>
  );
}
```
1.2. Типы компонентов
Функциональные компоненты (современный подход):

```jsx
// Function Declaration
function Button() {
  return <button>Нажать</button>;
}

// Arrow Function
const Header = () => {
  return <header>Заголовок сайта</header>;
};

// Более короткая запись для простых компонентов
const Title = () => <h1>Мой заголовок</h1>;
```
Классовые компоненты (устаревший, но поддерживаемый подход):

```jsx
import { Component } from 'react';

class Button extends Component {
  render() {
    return <button>Нажать</button>;
  }
}
```
Почему функциональные компоненты предпочтительнее:

Меньше кода, проще читать

Легче тестировать

Лучшая производительность

Современные хуки заменяют возможности классов [1]

## 2. Иерархия компонентов
### 2.1. Древовидная структура
React приложения строятся как дерево компонентов:

```text
App (корневой компонент)
├── Header
│   ├── Logo
│   ├── Navigation
│   └── UserMenu
├── Main
│   ├── Sidebar
│   └── Content
│       ├── Article
│       └── Comments
└── Footer
    ├── Links
    └── Copyright
```
Пример реальной иерархии:

```jsx
// Дочерние компоненты
function Logo() {
  return <div className="logo">Мой Сайт</div>;
}

function Navigation() {
  return (
    <nav>
      <a href="/">Главная</a>
      <a href="/about">О нас</a>
      <a href="/contact">Контакты</a>
    </nav>
  );
}

// Родительский компонент
function Header() {
  return (
    <header>
      <Logo />
      <Navigation />
    </header>
  );
}

// Корневой компонент
function App() {
  return (
    <div className="app">
      <Header />
      <main>Основное содержимое</main>
      <footer>Футер</footer>
    </div>
  );
}
```
## 3. Props (Properties) - передача данных в компоненты
### 3.1. Что такое props?
Props — это объект, содержащий все атрибуты, переданные компоненту. Props являются:

Неизменяемыми (immutable) - компонент не может изменять свои props

Однонаправленными - передаются только от родителя к ребенку

Любого типа - строки, числа, массивы, объекты, функции

```jsx
// Передача props
function App() {
  return (
    <div>
      <User name="Анна" age={25} isOnline={true} />
      <User name="Иван" age={30} isOnline={false} />
    </div>
  );
}

// Получение props через параметр функции
function User(props) {
  return (
    <div>
      <h2>Имя: {props.name}</h2>
      <p>Возраст: {props.age}</p>
      <p>Статус: {props.isOnline ? 'Онлайн' : 'Офлайн'}</p>
    </div>
  );
}
```
### 3.2. Деструктуризация props
Для удобства работы props часто деструктурируют:

```jsx
// Способ 1: Деструктуризация в параметрах
function User({ name, age, isOnline }) {
  return (
    <div>
      <h2>Имя: {name}</h2>
      <p>Возраст: {age}</p>
      <p>Статус: {isOnline ? 'Онлайн' : 'Офлайн'}</p>
    </div>
  );
}

// Способ 2: Деструктуризация в теле функции
function User(props) {
  const { name, age, isOnline } = props;
  
  return (
    <div>
      <h2>Имя: {name}</h2>
      <p>Возраст: {age}</p>
      <p>Статус: {isOnline ? 'Онлайн' : 'Офлайн'}</p>
    </div>
  );
}
```
### 3.3. Передача разных типов данных
```jsx
function App() {
  const userData = {
    name: "Мария",
    hobbies: ["чтение", "путешествия", "спорт"]
  };
  
  const calculateRating = () => Math.floor(Math.random() * 5) + 1;
  
  return (
    <Profile 
      user={userData}                    // Объект
      tags={["react", "javascript", "frontend"]} // Массив
      score={4.5}                        // Число
      isVerified={true}                  // Булево значение
      onUpdate={calculateRating}         // Функция
      content={<span>Премиум пользователь</span>} // JSX элемент
    />
  );
}

function Profile({ user, tags, score, isVerified, onUpdate, content }) {
  return (
    <div className="profile">
      <h2>{user.name}</h2>
      <p>Рейтинг: {score}</p>
      <p>Статус: {isVerified ? '✓ Подтвержден' : 'Не подтвержден'}</p>
      
      <div>
        <strong>Интересы:</strong>
        <ul>
          {user.hobbies.map((hobby, index) => (
            <li key={index}>{hobby}</li>
          ))}
        </ul>
      </div>
      
      <div>
        <strong>Теги:</strong>
        {tags.join(', ')}
      </div>
      
      <button onClick={onUpdate}>Обновить рейтинг</button>
      
      {content}
    </div>
  );
}
```
## 4. Специальный prop - children
### 4.1. Что такое children?
Children — это специальный prop, который содержит все, что находится между открывающим и закрывающим тегами компонента.

```jsx
// Компонент-контейнер
function Card({ children }) {
  return (
    <div className="card">
      <div className="card-content">
        {children}
      </div>
    </div>
  );
}

// Использование с children
function App() {
  return (
    <Card>
      <h2>Заголовок карточки</h2>
      <p>Это содержимое карточки, которое передается как children</p>
      <button>Кнопка в карточке</button>
    </Card>
  );
}
```
### 4.2. Разные формы children
```jsx
function Container({ children }) {
  return (
    <div className="container">
      {children}
    </div>
  );
}

// Разные варианты использования:
function App() {
  return (
    <div>
      {/* 1. Один элемент */}
      <Container>
        <h1>Один элемент</h1>
      </Container>
      
      {/* 2. Несколько элементов */}
      <Container>
        <h2>Заголовок</h2>
        <p>Текст</p>
        <button>Кнопка</button>
      </Container>
      
      {/* 3. Выражение JavaScript */}
      <Container>
        {["Яблоко", "Банан", "Апельсин"].map(fruit => (
          <span key={fruit}>{fruit} </span>
        ))}
      </Container>
      
      {/* 4. Пустой children */}
      <Container></Container>
    </div>
  );
}
```
### 4.3. Работа с несколькими children
```jsx
// Компонент с несколькими "слотами" для контента
function Layout({ header, sidebar, mainContent, footer }) {
  return (
    <div className="layout">
      <header className="header">{header}</header>
      <aside className="sidebar">{sidebar}</aside>
      <main className="main">{mainContent}</main>
      <footer className="footer">{footer}</footer>
    </div>
  );
}

// Использование
function App() {
  return (
    <Layout
      header={<h1>Мой сайт</h1>}
      sidebar={
        <nav>
          <ul>
            <li>Главная</li>
            <li>О нас</li>
            <li>Контакты</li>
          </ul>
        </nav>
      }
      mainContent={
        <article>
          <h2>Статья</h2>
          <p>Содержимое статьи...</p>
        </article>
      }
      footer={<p>© 2024 Мой сайт</p>}
    />
  );
}
```
## 5. Однонаправленный поток данных
### 5.1. Принцип однонаправленного потока
Данные в React передаются только сверху вниз — от родительских компонентов к дочерним. Это обеспечивает:

Предсказуемость — легко отслеживать поток данных

Отладку — проще находить ошибки

Поддерживаемость — код легче понимать и изменять

``` jsx
// ❌ НЕПРАВИЛЬНО: Дочерний компонент пытается изменить props
function User({ name, onNameChange }) {
  const handleClick = () => {
    // Так делать НЕЛЬЗЯ - props неизменяемы!
    name = "Новое имя"; // ❌
  };
  
  return (
    <div>
      <h2>{name}</h2>
      <button onClick={handleClick}>Изменить имя</button>
    </div>
  );
}
```
### 5.2. Правильная передача колбэков
``` jsx
// ✅ ПРАВИЛЬНО: Изменение данных через колбэк-функции
function App() {
  const [users, setUsers] = useState([
    { id: 1, name: "Анна" },
    { id: 2, name: "Иван" }
  ]);
  
  // Функция для изменения имени пользователя
  const updateUserName = (userId, newName) => {
    setUsers(users.map(user => 
      user.id === userId ? { ...user, name: newName } : user
    ));
  };
  
  return (
    <div>
      {users.map(user => (
        <User 
          key={user.id}
          user={user}
          onUpdateName={updateUserName}
        />
      ))}
    </div>
  );
}

function User({ user, onUpdateName }) {
  const handleClick = () => {
    // Вызываем функцию из родителя с новыми данными
    onUpdateName(user.id, "Новое имя");
  };
  
  return (
    <div>
      <h2>{user.name}</h2>
      <button onClick={handleClick}>Изменить имя</button>
    </div>
  );
}
```

## 6. Практические примеры и паттерны
### 6.1. Компонент списка с props
```jsx
function ProductList({ products, onProductClick, emptyMessage }) {
  if (!products || products.length === 0) {
    return <div className="empty-state">{emptyMessage}</div>;
  }
  
  return (
    <div className="product-list">
      {products.map(product => (
        <ProductItem 
          key={product.id}
          product={product}
          onClick={onProductClick}
        />
      ))}
    </div>
  );
}

function ProductItem({ product, onClick }) {
  const { id, name, price, image, inStock } = product;
  
  return (
    <div 
      className={`product-item ${!inStock ? 'out-of-stock' : ''}`}
      onClick={() => onClick(id)}
    >
      <img src={image} alt={name} />
      <h3>{name}</h3>
      <p className="price">{price} ₽</p>
      {!inStock && <span className="stock-label">Нет в наличии</span>}
    </div>
  );
}

// Использование
function App() {
  const products = [
    {
      id: 1,
      name: "Ноутбук",
      price: 50000,
      image: "/laptop.jpg",
      inStock: true
    },
    // ... другие товары
  ];
  
  const handleProductClick = (productId) => {
    console.log(`Клик по товару ${productId}`);
  };
  
  return (
    <ProductList
      products={products}
      onProductClick={handleProductClick}
      emptyMessage="Товары не найдены"
    />
  );
}
```
## 7. Лучшие практики работы с компонентами и props
### 7.1. Именование компонентов и props
```jsx
// ✅ ХОРОШО
function UserProfile({ userName, userAge, isActive }) {
  // ...
}

// ❌ ПЛОХО
function profile({ name, age, active }) {
  // ...
}
```
### 7.2. Default Props и значения по умолчанию
```jsx
// Способ 1: Деструктуризация с значениями по умолчанию
function Button({ 
  text = "Нажать", 
  type = "button", 
  variant = "primary",
  onClick 
}) {
  return (
    <button 
      type={type} 
      className={`btn btn-${variant}`}
      onClick={onClick}
    >
      {text}
    </button>
  );
}

// Способ 2: Default properties (устаревший, но поддерживается)
Button.defaultProps = {
  text: "Нажать",
  type: "button",
  variant: "primary"
};
7.3. Валидация props с PropTypes
jsx
import PropTypes from 'prop-types';

function UserCard({ user, onEdit, showActions }) {
  return (
    <div className="user-card">
      <h3>{user.name}</h3>
      <p>Email: {user.email}</p>
      {showActions && (
        <button onClick={() => onEdit(user.id)}>
          Редактировать
        </button>
      )}
    </div>
  );
}

UserCard.propTypes = {
  user: PropTypes.shape({
    id: PropTypes.number.isRequired,
    name: PropTypes.string.isRequired,
    email: PropTypes.string.isRequired
  }).isRequired,
  onEdit: PropTypes.func,
  showActions: PropTypes.bool
};

UserCard.defaultProps = {
  showActions: true,
  onEdit: () => {} // Пустая функция по умолчанию
};
```


## Выводы
Компоненты — строительные блоки React-приложений

Props — данные, передаваемые от родителя к ребенку (неизменяемые)

Children — специальный prop для вложенного содержимого

Однонаправленный поток — данные передаются только сверху вниз

Колбэки — способ взаимодействия ребенка с родителем

## Дополнительные материалы
1. [React Docs - Компоненты и Props](https://react.dev/learn/passing-props-to-a-component)

2. [Глубокое погружение в Props и Composition](https://ru.legacy.reactjs.org/docs/components-and-props.html)

3. [Практика работы с компонентами](https://metanit.com/web/react/2.4.php)